{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# ETL Project: Leading causes of death in the United States\n",
    "\n",
    "#### Aim:\n",
    "An analysis on the leading causes of death in the United States. This case study seeks to analyze the top causes of deaths from 2013 to 2016 by ranking death causes by year, state, and age-adjusted death rates. Further, would U.S. chronic disease indicators provide any insight into risk factors that may be associated with those leading causes of death? \n",
    "\n",
    "#### Notes:\n",
    "The 10 leading causes of death are classified by the International Classification of Diseases, Tenth Revision (ICD-10). Age-adjusted death rates are per 100,000 population. \n",
    "\n",
    "\n",
    "#### Data provided by:\n",
    "* [CDC/HCHS](https://catalog.data.gov/dataset/age-adjusted-death-rates-for-the-top-10-leading-causes-of-death-united-states-2013)\n",
    "\n",
    "* [CDC](https://catalog.data.gov/dataset/u-s-chronic-disease-indicators-cdi)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# import dependencies\n",
    "import pandas as pd\n",
    "import pymysql\n",
    "from sqlalchemy import create_engine"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# read csv file for data on leading causes of death\n",
    "leading_causes_death_df = pd.read_csv('Resources/NCHS_-_Leading_Causes_of_Death__United_States.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Year</th>\n",
       "      <th>113 Cause Name</th>\n",
       "      <th>Cause Name</th>\n",
       "      <th>State</th>\n",
       "      <th>Deaths</th>\n",
       "      <th>Age-adjusted Death Rate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2016</td>\n",
       "      <td>Accidents (unintentional injuries) (V01-X59,Y8...</td>\n",
       "      <td>Unintentional injuries</td>\n",
       "      <td>Alabama</td>\n",
       "      <td>2755</td>\n",
       "      <td>55.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2016</td>\n",
       "      <td>Accidents (unintentional injuries) (V01-X59,Y8...</td>\n",
       "      <td>Unintentional injuries</td>\n",
       "      <td>Alaska</td>\n",
       "      <td>439</td>\n",
       "      <td>63.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2016</td>\n",
       "      <td>Accidents (unintentional injuries) (V01-X59,Y8...</td>\n",
       "      <td>Unintentional injuries</td>\n",
       "      <td>Arizona</td>\n",
       "      <td>4010</td>\n",
       "      <td>54.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2016</td>\n",
       "      <td>Accidents (unintentional injuries) (V01-X59,Y8...</td>\n",
       "      <td>Unintentional injuries</td>\n",
       "      <td>Arkansas</td>\n",
       "      <td>1604</td>\n",
       "      <td>51.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2016</td>\n",
       "      <td>Accidents (unintentional injuries) (V01-X59,Y8...</td>\n",
       "      <td>Unintentional injuries</td>\n",
       "      <td>California</td>\n",
       "      <td>13213</td>\n",
       "      <td>32.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Year                                     113 Cause Name  \\\n",
       "0  2016  Accidents (unintentional injuries) (V01-X59,Y8...   \n",
       "1  2016  Accidents (unintentional injuries) (V01-X59,Y8...   \n",
       "2  2016  Accidents (unintentional injuries) (V01-X59,Y8...   \n",
       "3  2016  Accidents (unintentional injuries) (V01-X59,Y8...   \n",
       "4  2016  Accidents (unintentional injuries) (V01-X59,Y8...   \n",
       "\n",
       "               Cause Name       State  Deaths  Age-adjusted Death Rate  \n",
       "0  Unintentional injuries     Alabama    2755                     55.5  \n",
       "1  Unintentional injuries      Alaska     439                     63.1  \n",
       "2  Unintentional injuries     Arizona    4010                     54.2  \n",
       "3  Unintentional injuries    Arkansas    1604                     51.8  \n",
       "4  Unintentional injuries  California   13213                     32.0  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# preview the dataframe created\n",
    "leading_causes_death_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>cause_name</th>\n",
       "      <th>state</th>\n",
       "      <th>deaths</th>\n",
       "      <th>age-ajusted_death_rate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10295</th>\n",
       "      <td>1999</td>\n",
       "      <td>Unintentional injuries</td>\n",
       "      <td>Wyoming</td>\n",
       "      <td>258</td>\n",
       "      <td>52.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1418</th>\n",
       "      <td>1999</td>\n",
       "      <td>Alzheimer's disease</td>\n",
       "      <td>Minnesota</td>\n",
       "      <td>1083</td>\n",
       "      <td>21.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8726</th>\n",
       "      <td>1999</td>\n",
       "      <td>Suicide</td>\n",
       "      <td>Illinois</td>\n",
       "      <td>1020</td>\n",
       "      <td>8.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7016</th>\n",
       "      <td>1999</td>\n",
       "      <td>Kidney disease</td>\n",
       "      <td>Michigan</td>\n",
       "      <td>1417</td>\n",
       "      <td>15.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4334</th>\n",
       "      <td>1999</td>\n",
       "      <td>Diabetes</td>\n",
       "      <td>New Hampshire</td>\n",
       "      <td>294</td>\n",
       "      <td>25.3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       year              cause_name          state  deaths  \\\n",
       "10295  1999  Unintentional injuries        Wyoming     258   \n",
       "1418   1999     Alzheimer's disease      Minnesota    1083   \n",
       "8726   1999                 Suicide       Illinois    1020   \n",
       "7016   1999          Kidney disease       Michigan    1417   \n",
       "4334   1999                Diabetes  New Hampshire     294   \n",
       "\n",
       "       age-ajusted_death_rate  \n",
       "10295                    52.8  \n",
       "1418                     21.1  \n",
       "8726                      8.3  \n",
       "7016                     15.0  \n",
       "4334                     25.3  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## cleaning the database\n",
    "\n",
    "# Remove cause_name and state columns, Rename columns into a new dataframe\n",
    "leading_causes = leading_causes_death_df[['Year', 'Cause Name', 'State','Deaths', 'Age-adjusted Death Rate']].copy()\n",
    "leading_causes = leading_causes.rename(columns={\n",
    "    \"Year\":\"year\",\n",
    "    \"Cause Name\": \"cause_name\",\n",
    "    \"State\": \"state\",\n",
    "    \"Deaths\": \"deaths\",\n",
    "    \"Age-adjusted Death Rate\": \"age-ajusted_death_rate\"\n",
    "})\n",
    "leading_causes.sort_values(by=[\"year\"]).head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<bound method Series.unique of 10281    Unintentional injuries\n",
       "3708                       CLRD\n",
       "3726                       CLRD\n",
       "8946                    Suicide\n",
       "3744                       CLRD\n",
       "3762                       CLRD\n",
       "3780                       CLRD\n",
       "3798                   Diabetes\n",
       "8928                    Suicide\n",
       "3816                   Diabetes\n",
       "3834                   Diabetes\n",
       "3690                       CLRD\n",
       "3852                   Diabetes\n",
       "8910                    Suicide\n",
       "3888                   Diabetes\n",
       "3906                   Diabetes\n",
       "3924                   Diabetes\n",
       "3942                   Diabetes\n",
       "8892                    Suicide\n",
       "3960                   Diabetes\n",
       "3978                   Diabetes\n",
       "3996                   Diabetes\n",
       "4014                   Diabetes\n",
       "3870                   Diabetes\n",
       "3672                       CLRD\n",
       "8964                    Suicide\n",
       "3654                       CLRD\n",
       "3312                       CLRD\n",
       "3330                       CLRD\n",
       "3348                       CLRD\n",
       "                  ...          \n",
       "5146              Heart disease\n",
       "4641                   Diabetes\n",
       "4659                   Diabetes\n",
       "4677                   Diabetes\n",
       "4695                   Diabetes\n",
       "4713                   Diabetes\n",
       "4731              Heart disease\n",
       "4749              Heart disease\n",
       "4767              Heart disease\n",
       "4785              Heart disease\n",
       "4803              Heart disease\n",
       "4821              Heart disease\n",
       "4839              Heart disease\n",
       "4857              Heart disease\n",
       "4875              Heart disease\n",
       "4893              Heart disease\n",
       "4911              Heart disease\n",
       "4929              Heart disease\n",
       "4947              Heart disease\n",
       "4983              Heart disease\n",
       "5001              Heart disease\n",
       "5019              Heart disease\n",
       "5037              Heart disease\n",
       "5055              Heart disease\n",
       "5073              Heart disease\n",
       "5091              Heart disease\n",
       "5109              Heart disease\n",
       "5128              Heart disease\n",
       "5164              Heart disease\n",
       "4965              Heart disease\n",
       "Name: cause_name, Length: 2288, dtype: object>"
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Filter leading_causes for years >=2013\n",
    "leading_causes_2013_to_2016 = leading_causes.loc[leading_causes['year'] >= 2013,:]\n",
    "leading_causes_2013_to_2016=leading_causes_2013_to_2016.sort_values(by=['year'])\n",
    "\n",
    "#### PUT THIS DATAFRAME INTO THE DATABASE\n",
    "leading_causes_2013_to_2016.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Cleaning dataframe by choosing only row which has country not equal to \"NAN\"\n",
    "leading_causes_2013_to_2016[\"cause_name\"]= leading_causes_2013_to_2016[\"cause_name\"].replace(\"Diseases of heart (I00-I09,I11,I13,I20-I51)\", \"Heart disease\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [],
   "source": [
    "# # Group dataframe by year and cause_name, finding the sum of deaths \n",
    "# leading_causes_2013_to_2016_grouped=leading_causes_2013_to_2016.groupby([\"year\", \"cause_name\"]).sum().copy()\n",
    "# leading_causes_2013_to_2016_grouped.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Connect to MySQL database"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [],
   "source": [
    "#engine = create_engine(\"mysql://root:bdasl2019@localhost:3306/leading_causes_of_death_db\")\n",
    "pymysql.install_as_MySQLdb()\n",
    "connection_string = \"root:bdasl2019@127.0.0.1/leading_causes_of_death_db\"\n",
    "engine = create_engine(f'mysql://{connection_string}')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "leading_causes_2013_to_2016.to_sql(name='leading_causes', con=engine, if_exists='append', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>cause_name</th>\n",
       "      <th>state</th>\n",
       "      <th>deaths</th>\n",
       "      <th>age-ajusted_death_rate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2013</td>\n",
       "      <td>Accidents (unintentional injuries) (V01-X59,Y8...</td>\n",
       "      <td>Wyoming</td>\n",
       "      <td>325</td>\n",
       "      <td>55.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2013</td>\n",
       "      <td>Chronic lower respiratory diseases (J40-J47)</td>\n",
       "      <td>Virginia</td>\n",
       "      <td>3181</td>\n",
       "      <td>37.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2013</td>\n",
       "      <td>Chronic lower respiratory diseases (J40-J47)</td>\n",
       "      <td>Washington</td>\n",
       "      <td>2933</td>\n",
       "      <td>39.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2013</td>\n",
       "      <td>Intentional self-harm (suicide) (*U03,X60-X84,...</td>\n",
       "      <td>Montana</td>\n",
       "      <td>243</td>\n",
       "      <td>23.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2013</td>\n",
       "      <td>Chronic lower respiratory diseases (J40-J47)</td>\n",
       "      <td>West Virginia</td>\n",
       "      <td>1590</td>\n",
       "      <td>64.6</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   year                                         cause_name          state  \\\n",
       "0  2013  Accidents (unintentional injuries) (V01-X59,Y8...        Wyoming   \n",
       "1  2013       Chronic lower respiratory diseases (J40-J47)       Virginia   \n",
       "2  2013       Chronic lower respiratory diseases (J40-J47)     Washington   \n",
       "3  2013  Intentional self-harm (suicide) (*U03,X60-X84,...        Montana   \n",
       "4  2013       Chronic lower respiratory diseases (J40-J47)  West Virginia   \n",
       "\n",
       "   deaths  age-ajusted_death_rate  \n",
       "0     325                    55.2  \n",
       "1    3181                    37.3  \n",
       "2    2933                    39.4  \n",
       "3     243                    23.7  \n",
       "4    1590                    64.6  "
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.read_sql_query('SELECT * FROM leading_causes', con=engine).head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['death_causes',\n",
       " 'deaths_per_state',\n",
       " 'leading_causes',\n",
       " 'state_cause_deaths',\n",
       " 'state_causes_df',\n",
       " 'state_deaths']"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "engine.table_names()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>cause_name</th>\n",
       "      <th>total_US_deaths</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2013</td>\n",
       "      <td>Accidents (unintentional injuries) (V01-X59,Y8...</td>\n",
       "      <td>1305570.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2013</td>\n",
       "      <td>All Causes</td>\n",
       "      <td>51939860.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2013</td>\n",
       "      <td>Alzheimer's disease</td>\n",
       "      <td>847670.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2013</td>\n",
       "      <td>Alzheimer's disease (G30)</td>\n",
       "      <td>847670.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2013</td>\n",
       "      <td>Cancer</td>\n",
       "      <td>5848810.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2013</td>\n",
       "      <td>Cerebrovascular diseases (I60-I69)</td>\n",
       "      <td>1289780.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2013</td>\n",
       "      <td>Chronic lower respiratory diseases (J40-J47)</td>\n",
       "      <td>1492050.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2013</td>\n",
       "      <td>CLRD</td>\n",
       "      <td>1492050.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2013</td>\n",
       "      <td>Diabetes</td>\n",
       "      <td>755780.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2013</td>\n",
       "      <td>Diabetes mellitus (E10-E14)</td>\n",
       "      <td>755780.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2013</td>\n",
       "      <td>Diseases of heart (I00-I09,I11,I13,I20-I51)</td>\n",
       "      <td>6111050.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>2013</td>\n",
       "      <td>Heart disease</td>\n",
       "      <td>6111050.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>2013</td>\n",
       "      <td>Influenza and pneumonia</td>\n",
       "      <td>569790.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>2013</td>\n",
       "      <td>Influenza and pneumonia (J09-J18)</td>\n",
       "      <td>569790.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>2013</td>\n",
       "      <td>Intentional self-harm (suicide) (*U03,X60-X84,...</td>\n",
       "      <td>411490.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2013</td>\n",
       "      <td>Kidney disease</td>\n",
       "      <td>471120.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2013</td>\n",
       "      <td>Malignant neoplasms (C00-C97)</td>\n",
       "      <td>5848810.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>2013</td>\n",
       "      <td>Nephritis, nephrotic syndrome and nephrosis (N...</td>\n",
       "      <td>471120.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>2013</td>\n",
       "      <td>Stroke</td>\n",
       "      <td>1289780.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>2013</td>\n",
       "      <td>Suicide</td>\n",
       "      <td>411490.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>2013</td>\n",
       "      <td>Unintentional injuries</td>\n",
       "      <td>1305570.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>2014</td>\n",
       "      <td>Accidents (unintentional injuries) (V01-X59,Y8...</td>\n",
       "      <td>1359280.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>2014</td>\n",
       "      <td>All Causes</td>\n",
       "      <td>52528360.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>2014</td>\n",
       "      <td>Alzheimer's disease</td>\n",
       "      <td>935410.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>2014</td>\n",
       "      <td>Alzheimer's disease (G30)</td>\n",
       "      <td>935410.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>2014</td>\n",
       "      <td>Cancer</td>\n",
       "      <td>5917000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>2014</td>\n",
       "      <td>Cerebrovascular diseases (I60-I69)</td>\n",
       "      <td>1331030.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>2014</td>\n",
       "      <td>Chronic lower respiratory diseases (J40-J47)</td>\n",
       "      <td>1471010.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>2014</td>\n",
       "      <td>CLRD</td>\n",
       "      <td>1471010.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>2014</td>\n",
       "      <td>Diabetes</td>\n",
       "      <td>764880.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>54</th>\n",
       "      <td>2015</td>\n",
       "      <td>Influenza and pneumonia</td>\n",
       "      <td>570620.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55</th>\n",
       "      <td>2015</td>\n",
       "      <td>Influenza and pneumonia (J09-J18)</td>\n",
       "      <td>570620.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56</th>\n",
       "      <td>2015</td>\n",
       "      <td>Intentional self-harm (suicide) (*U03,X60-X84,...</td>\n",
       "      <td>441930.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57</th>\n",
       "      <td>2015</td>\n",
       "      <td>Kidney disease</td>\n",
       "      <td>499590.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58</th>\n",
       "      <td>2015</td>\n",
       "      <td>Malignant neoplasms (C00-C97)</td>\n",
       "      <td>5959300.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59</th>\n",
       "      <td>2015</td>\n",
       "      <td>Nephritis, nephrotic syndrome and nephrosis (N...</td>\n",
       "      <td>499590.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>60</th>\n",
       "      <td>2015</td>\n",
       "      <td>Stroke</td>\n",
       "      <td>1403230.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>61</th>\n",
       "      <td>2015</td>\n",
       "      <td>Suicide</td>\n",
       "      <td>441930.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62</th>\n",
       "      <td>2015</td>\n",
       "      <td>Unintentional injuries</td>\n",
       "      <td>1465710.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63</th>\n",
       "      <td>2016</td>\n",
       "      <td>Accidents (unintentional injuries) (V01-X59,Y8...</td>\n",
       "      <td>1613740.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>64</th>\n",
       "      <td>2016</td>\n",
       "      <td>All Causes</td>\n",
       "      <td>50637230.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>65</th>\n",
       "      <td>2016</td>\n",
       "      <td>Alzheimer's disease</td>\n",
       "      <td>1161030.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66</th>\n",
       "      <td>2016</td>\n",
       "      <td>Alzheimer's disease (G30)</td>\n",
       "      <td>1161030.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>67</th>\n",
       "      <td>2016</td>\n",
       "      <td>Cancer</td>\n",
       "      <td>5980380.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>68</th>\n",
       "      <td>2016</td>\n",
       "      <td>Cerebrovascular diseases (I60-I69)</td>\n",
       "      <td>1421420.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>69</th>\n",
       "      <td>2016</td>\n",
       "      <td>Chronic lower respiratory diseases (J40-J47)</td>\n",
       "      <td>1545960.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>70</th>\n",
       "      <td>2016</td>\n",
       "      <td>CLRD</td>\n",
       "      <td>1545960.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>71</th>\n",
       "      <td>2016</td>\n",
       "      <td>Diabetes</td>\n",
       "      <td>800580.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>72</th>\n",
       "      <td>2016</td>\n",
       "      <td>Diabetes mellitus (E10-E14)</td>\n",
       "      <td>800580.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>73</th>\n",
       "      <td>2016</td>\n",
       "      <td>Diseases of heart (I00-I09,I11,I13,I20-I51)</td>\n",
       "      <td>6352600.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>74</th>\n",
       "      <td>2016</td>\n",
       "      <td>Heart disease</td>\n",
       "      <td>6352600.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75</th>\n",
       "      <td>2016</td>\n",
       "      <td>Influenza and pneumonia</td>\n",
       "      <td>515370.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>76</th>\n",
       "      <td>2016</td>\n",
       "      <td>Influenza and pneumonia (J09-J18)</td>\n",
       "      <td>515370.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77</th>\n",
       "      <td>2016</td>\n",
       "      <td>Intentional self-harm (suicide) (*U03,X60-X84,...</td>\n",
       "      <td>449650.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>78</th>\n",
       "      <td>2016</td>\n",
       "      <td>Kidney disease</td>\n",
       "      <td>500460.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>79</th>\n",
       "      <td>2016</td>\n",
       "      <td>Malignant neoplasms (C00-C97)</td>\n",
       "      <td>5980380.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>80</th>\n",
       "      <td>2016</td>\n",
       "      <td>Nephritis, nephrotic syndrome and nephrosis (N...</td>\n",
       "      <td>500460.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>81</th>\n",
       "      <td>2016</td>\n",
       "      <td>Stroke</td>\n",
       "      <td>1421420.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>82</th>\n",
       "      <td>2016</td>\n",
       "      <td>Suicide</td>\n",
       "      <td>449650.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>83</th>\n",
       "      <td>2016</td>\n",
       "      <td>Unintentional injuries</td>\n",
       "      <td>1613740.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>84 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    year                                         cause_name  total_US_deaths\n",
       "0   2013  Accidents (unintentional injuries) (V01-X59,Y8...        1305570.0\n",
       "1   2013                                         All Causes       51939860.0\n",
       "2   2013                                Alzheimer's disease         847670.0\n",
       "3   2013                          Alzheimer's disease (G30)         847670.0\n",
       "4   2013                                             Cancer        5848810.0\n",
       "5   2013                 Cerebrovascular diseases (I60-I69)        1289780.0\n",
       "6   2013       Chronic lower respiratory diseases (J40-J47)        1492050.0\n",
       "7   2013                                               CLRD        1492050.0\n",
       "8   2013                                           Diabetes         755780.0\n",
       "9   2013                        Diabetes mellitus (E10-E14)         755780.0\n",
       "10  2013        Diseases of heart (I00-I09,I11,I13,I20-I51)        6111050.0\n",
       "11  2013                                      Heart disease        6111050.0\n",
       "12  2013                            Influenza and pneumonia         569790.0\n",
       "13  2013                  Influenza and pneumonia (J09-J18)         569790.0\n",
       "14  2013  Intentional self-harm (suicide) (*U03,X60-X84,...         411490.0\n",
       "15  2013                                     Kidney disease         471120.0\n",
       "16  2013                      Malignant neoplasms (C00-C97)        5848810.0\n",
       "17  2013  Nephritis, nephrotic syndrome and nephrosis (N...         471120.0\n",
       "18  2013                                             Stroke        1289780.0\n",
       "19  2013                                            Suicide         411490.0\n",
       "20  2013                             Unintentional injuries        1305570.0\n",
       "21  2014  Accidents (unintentional injuries) (V01-X59,Y8...        1359280.0\n",
       "22  2014                                         All Causes       52528360.0\n",
       "23  2014                                Alzheimer's disease         935410.0\n",
       "24  2014                          Alzheimer's disease (G30)         935410.0\n",
       "25  2014                                             Cancer        5917000.0\n",
       "26  2014                 Cerebrovascular diseases (I60-I69)        1331030.0\n",
       "27  2014       Chronic lower respiratory diseases (J40-J47)        1471010.0\n",
       "28  2014                                               CLRD        1471010.0\n",
       "29  2014                                           Diabetes         764880.0\n",
       "..   ...                                                ...              ...\n",
       "54  2015                            Influenza and pneumonia         570620.0\n",
       "55  2015                  Influenza and pneumonia (J09-J18)         570620.0\n",
       "56  2015  Intentional self-harm (suicide) (*U03,X60-X84,...         441930.0\n",
       "57  2015                                     Kidney disease         499590.0\n",
       "58  2015                      Malignant neoplasms (C00-C97)        5959300.0\n",
       "59  2015  Nephritis, nephrotic syndrome and nephrosis (N...         499590.0\n",
       "60  2015                                             Stroke        1403230.0\n",
       "61  2015                                            Suicide         441930.0\n",
       "62  2015                             Unintentional injuries        1465710.0\n",
       "63  2016  Accidents (unintentional injuries) (V01-X59,Y8...        1613740.0\n",
       "64  2016                                         All Causes       50637230.0\n",
       "65  2016                                Alzheimer's disease        1161030.0\n",
       "66  2016                          Alzheimer's disease (G30)        1161030.0\n",
       "67  2016                                             Cancer        5980380.0\n",
       "68  2016                 Cerebrovascular diseases (I60-I69)        1421420.0\n",
       "69  2016       Chronic lower respiratory diseases (J40-J47)        1545960.0\n",
       "70  2016                                               CLRD        1545960.0\n",
       "71  2016                                           Diabetes         800580.0\n",
       "72  2016                        Diabetes mellitus (E10-E14)         800580.0\n",
       "73  2016        Diseases of heart (I00-I09,I11,I13,I20-I51)        6352600.0\n",
       "74  2016                                      Heart disease        6352600.0\n",
       "75  2016                            Influenza and pneumonia         515370.0\n",
       "76  2016                  Influenza and pneumonia (J09-J18)         515370.0\n",
       "77  2016  Intentional self-harm (suicide) (*U03,X60-X84,...         449650.0\n",
       "78  2016                                     Kidney disease         500460.0\n",
       "79  2016                      Malignant neoplasms (C00-C97)        5980380.0\n",
       "80  2016  Nephritis, nephrotic syndrome and nephrosis (N...         500460.0\n",
       "81  2016                                             Stroke        1421420.0\n",
       "82  2016                                            Suicide         449650.0\n",
       "83  2016                             Unintentional injuries        1613740.0\n",
       "\n",
       "[84 rows x 3 columns]"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Each year how many people died with which cause?\n",
    "# QUERY TO SUM DEATHS, GROUPED BY YEAR AND CAUSE OF DEATH\n",
    "\n",
    "pd.read_sql_query('SELECT year, cause_name,\\\n",
    "                  SUM(deaths) as total_US_deaths\\\n",
    "                  FROM leading_causes\\\n",
    "                  GROUP BY year, cause_name\\\n",
    "                  ORDER BY year ASC', con=engine)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Death analysis per state"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "State\n",
       "United States           181513710\n",
       "California               17973270\n",
       "Florida                  13205950\n",
       "Texas                    12835080\n",
       "New York                 10674680\n",
       "Pennsylvania              9061000\n",
       "Ohio                      8101930\n",
       "Illinois                  7350320\n",
       "Michigan                  6648630\n",
       "North Carolina            6016450\n",
       "Georgia                   5407170\n",
       "New Jersey                4977160\n",
       "Tennessee                 4594610\n",
       "Virginia                  4443910\n",
       "Indiana                   4294150\n",
       "Missouri                  4150380\n",
       "Massachusetts             3809380\n",
       "Arizona                   3708960\n",
       "Washington                3704330\n",
       "Alabama                   3552640\n",
       "Wisconsin                 3535230\n",
       "Maryland                  3204720\n",
       "South Carolina            3203140\n",
       "Kentucky                  3196950\n",
       "Louisiana                 3059830\n",
       "Minnesota                 2863950\n",
       "Oklahoma                  2755540\n",
       "Colorado                  2465650\n",
       "Oregon                    2386550\n",
       "Mississippi               2198500\n",
       "Arkansas                  2193110\n",
       "Connecticut               2060670\n",
       "Iowa                      2047320\n",
       "Kansas                    1787430\n",
       "Nevada                    1598120\n",
       "West Virginia             1553000\n",
       "New Mexico                1208660\n",
       "Utah                      1164660\n",
       "Nebraska                  1105160\n",
       "Maine                      961930\n",
       "Idaho                      889950\n",
       "New Hampshire              806450\n",
       "Hawaii                     751920\n",
       "Rhode Island               682050\n",
       "Montana                    667330\n",
       "Delaware                   586900\n",
       "South Dakota               532910\n",
       "North Dakota               432370\n",
       "Vermont                    402690\n",
       "District of Columbia       332540\n",
       "Wyoming                    324710\n",
       "Alaska                     291500\n",
       "Name: total_state_deaths, dtype: int64"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Deaths per state\n",
    "state_deaths = pd.read_sql_query('SELECT state as State, deaths as total_state_deaths \\\n",
    "                FROM leading_causes', con=engine)\n",
    "# Group by state\n",
    "deaths_state = state_deaths.groupby(['State'])\n",
    "# count total number of deaths per state\n",
    "deaths_state_df = deaths_state['total_state_deaths'].sum()\n",
    "deaths_per_state = deaths_state_df.sort_values(ascending=False)\n",
    "deaths_per_state"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### As per above report top 10 states having more death count are [California, Florida, Texas, New York, Pennsylvania, Ohio, Illinois, Michigan, North Carolina, Georgia]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Adding selected columns to mysql\n",
    "state_deaths.to_sql(name='state_deaths', con=engine, if_exists='append', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<bound method Series.sort_values of state    cause_name                                                             year\n",
      "Alabama  Accidents (unintentional injuries) (V01-X59,Y85-Y86)                   2013     11645\n",
      "                                                                                2014     12315\n",
      "                                                                                2015     12760\n",
      "                                                                                2016     13775\n",
      "         All Causes                                                             2013    250945\n",
      "                                                                                2014    251075\n",
      "                                                                                2015    259545\n",
      "                                                                                2016    262330\n",
      "         All causes                                                             2013    250945\n",
      "                                                                                2014    251075\n",
      "                                                                                2015    259545\n",
      "                                                                                2016    262330\n",
      "         Alzheimer's disease                                                    2013      6990\n",
      "                                                                                2014      9425\n",
      "                                                                                2015     11410\n",
      "                                                                                2016     12535\n",
      "         Alzheimer's disease (G30)                                              2013      6990\n",
      "                                                                                2014      9425\n",
      "                                                                                2015     11410\n",
      "                                                                                2016     12535\n",
      "         CLRD                                                                   2013     15215\n",
      "                                                                                2014     15250\n",
      "                                                                                2015     16395\n",
      "                                                                                2016     16630\n",
      "         Cancer                                                                 2013     51640\n",
      "                                                                                2014     51430\n",
      "                                                                                2015     51770\n",
      "                                                                                2016     52095\n",
      "         Cerebrovascular diseases (I60-I69)                                     2013     13020\n",
      "                                                                                2014     13315\n",
      "                                                                                         ...  \n",
      "Wyoming  Influenza and pneumonia (J09-J18)                                      2015       495\n",
      "                                                                                2016       495\n",
      "         Intentional self-harm (suicide) (*U03,X60-X84,Y87.0)                   2013       645\n",
      "                                                                                2014       600\n",
      "                                                                                2015       785\n",
      "                                                                                2016       720\n",
      "         Kidney disease                                                         2013       280\n",
      "                                                                                2014       390\n",
      "                                                                                2015       430\n",
      "                                                                                2016       330\n",
      "         Malignant neoplasms (C00-C97)                                          2013      4730\n",
      "                                                                                2014      4610\n",
      "                                                                                2015      4655\n",
      "                                                                                2016      4810\n",
      "         Nephritis, nephrotic syndrome and nephrosis (N00-N07,N17-N19,N25-N27)  2013       280\n",
      "                                                                                2014       390\n",
      "                                                                                2015       430\n",
      "                                                                                2016       330\n",
      "         Stroke                                                                 2013      1065\n",
      "                                                                                2014       945\n",
      "                                                                                2015       990\n",
      "                                                                                2016      1040\n",
      "         Suicide                                                                2013       645\n",
      "                                                                                2014       600\n",
      "                                                                                2015       785\n",
      "                                                                                2016       720\n",
      "         Unintentional injuries                                                 2013      1625\n",
      "                                                                                2014      1805\n",
      "                                                                                2015      2000\n",
      "                                                                                2016      1855\n",
      "Name: total_state_deaths, Length: 4576, dtype: int64>\n"
     ]
    }
   ],
   "source": [
    "# Deaths in each state per cause per year\n",
    "state_cause_deaths = pd.read_sql_query('SELECT state, cause_name, year, deaths as total_state_deaths \\\n",
    "                FROM leading_causes', con=engine)\n",
    "# Groupby statem, cause name, year\n",
    "deaths_state = state_cause_deaths.groupby(['state', 'cause_name', 'year'])\n",
    "# count total deaths\n",
    "deaths_state_df = deaths_state['total_state_deaths'].sum()\n",
    "deaths_state_df = deaths_state_df.sort_values\n",
    "print(deaths_state_df)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Adding selected data to mysql\n",
    "state_cause_deaths.to_sql(name='state_cause_deaths', con=engine, if_exists='append', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "cause_name\n",
       "All Causes                                                               104679025\n",
       "All causes                                                               104679025\n",
       "Heart disease                                                             24945550\n",
       "Diseases of heart (I00-I09,I11,I13,I20-I51)                               24945550\n",
       "Malignant neoplasms (C00-C97)                                             23705490\n",
       "Cancer                                                                    23705490\n",
       "CLRD                                                                       6059430\n",
       "Chronic lower respiratory diseases (J40-J47)                               6059430\n",
       "Unintentional injuries                                                     5744300\n",
       "Accidents (unintentional injuries) (V01-X59,Y85-Y86)                       5744300\n",
       "Cerebrovascular diseases (I60-I69)                                         5445460\n",
       "Stroke                                                                     5445460\n",
       "Alzheimer's disease (G30)                                                  4049720\n",
       "Alzheimer's disease                                                        4049720\n",
       "Diabetes                                                                   3116590\n",
       "Diabetes mellitus (E10-E14)                                                3116590\n",
       "Influenza and pneumonia                                                    2208050\n",
       "Influenza and pneumonia (J09-J18)                                          2208050\n",
       "Kidney disease                                                             1952630\n",
       "Nephritis, nephrotic syndrome and nephrosis (N00-N07,N17-N19,N25-N27)      1952630\n",
       "Suicide                                                                    1731330\n",
       "Intentional self-harm (suicide) (*U03,X60-X84,Y87.0)                       1731330\n",
       "Name: total_state_deaths, dtype: int64"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Deaths per cause\n",
    "death_causes = pd.read_sql_query('SELECT cause_name, deaths as total_state_deaths \\\n",
    "                FROM leading_causes', con=engine)\n",
    "# Group by cause name\n",
    "state_causes_group = death_causes.groupby(['cause_name'])\n",
    "# count total number of deaths per cause\n",
    "state_causes_df = state_causes_group['total_state_deaths'].sum()\n",
    "state_causes_df.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### As per above analysis, top causes of death are Heart disease, followed by Malignant neoplasms and then cancer."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [],
   "source": [
    "death_causes.to_sql(name='death_causes', con=engine, if_exists='append', index=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Chronic Disease Indicators\n",
    "\n",
    "#### Column Descriptions:\n",
    "* YearStart - Starting Year\n",
    "* YearEnd - Ending Year\n",
    "* LocationAbbr - Location Abbreviation\n",
    "* LocationDesc - Location Description\n",
    "* DataSource - Data Source Abbreviation\n",
    "* Topic - Topic\n",
    "* Question - Question full-length text\n",
    "* Response - Response\n",
    "* DataValueUnit - The unit, such as $, %, years, etc.\n",
    "* DataValueType - The data type, such as prevalence or mean\n",
    "* DataValue - Data Value, such as 14.7 or Category 1\n",
    "* DataValueAlt - Equal to Data Value, but formatting is numeric\n",
    "* DataValueFootnoteSymbol\t- Footnote Symbol\n",
    "* DatavalueFootnote - Footnote Text\n",
    "* LowConfidenceLimit - Low Confidence Limit\n",
    "* HighConfidenceLimit - High Confidence Limit\n",
    "* StratificationCategory1\t- The category of the stratification, such as * Gender, Overall, or Race/Ethnicity\n",
    "* Stratification1\t- The stratification within the category, such as Male or Female, White/non-Hispanic, Hispanic, Black/non-Hispanic, American Indian or Alaska Native, Asian or Pacific Islander, Multi-racial/non-Hispanic, Other/non-Hispanic, or Overall\n",
    "* StratificationCategory2\n",
    "* Stratification2\t\n",
    "* StratificationCategory3\n",
    "* Stratification3\t\n",
    "* GeoLocation\t- Location code to be used for Geocoding\n",
    "* ResponseID - Identifier for the Response\n",
    "* LocationID - Location Identifier\n",
    "* TopicID\t\n",
    "* QuestionID - Question Identifier\n",
    "* DataValueTypeID\t- Identifier for the Data Value Type\n",
    "* StratificationCategoryID1 - Identifier for stratification category 1\n",
    "* StratificationID1 - Identifier for stratification 1\n",
    "* StratificationCategoryID2\t\n",
    "* StratificationID2\t\n",
    "* StratificationCategoryID3\t\n",
    "* StratificationID3\t\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# read chronic diseases indicators csv\n",
    "CDI_df = pd.read_csv('Resources/U.S._Chronic_Disease_Indicators__CDI_.csv')\n",
    "CDI_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "## CLEAN UP DATAFRAME\n",
    "# Remove uncessary columns\n",
    "CDI_df = CDI_df[['YearStart', 'LocationAbbr', 'LocationDesc', 'Topic', 'Question', 'DataValue', 'DataValueUnit', 'DataValueType', 'StratificationCategory1', 'Stratification1']]\n",
    "\n",
    "CDI_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Obtain rows only for the all of the United States\n",
    "CDI_US = CDI_df.loc[CDI_df['LocationAbbr']==\"US\",:]\n",
    "\n",
    "# Obtain rows only for the years >=2013\n",
    "CDI_US = CDI_US.loc[CDI_US['YearStart']>=2013, :]\n",
    "CDI_US"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Separate crude prevalence and age-adjusted prevalence into separate dataframes\n",
    "CDI_US_crude = CDI_US.loc[CDI_US['DataValueType']==\"Crude Prevalence\",:]\n",
    "CDI_US_age_adjusted = CDI_US.loc[CDI_US['DataValueType']==\"Age-adjusted Prevalence\", :]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "CDI_US_crude.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Separate CDI_US_crude into 3 stratification categories: Overall, Gender Male, Gender Female\n",
    "\n",
    "# Overall\n",
    "CDI_US_crude_overall = CDI_US_crude.loc[CDI_US_crude['Stratification1']==\"Overall\",:]\n",
    "# Male\n",
    "CDI_US_crude_male = CDI_US_crude.loc[CDI_US_crude['Stratification1']==\"Male\",:]\n",
    "# Female\n",
    "CDI_US_crude_female = CDI_US_crude.loc[CDI_US_crude['Stratification1']==\"Female\",:]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "CDI_US_crude_overall.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "CDI_US_crude_male.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "CDI_US_crude_female.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Only Age adjusted datavaluetypes\n",
    "CDI_US_age_adjusted.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Separate CDI_US_crude into 3 stratification categories: Overall, Gender Male, Gender Female\n",
    "\n",
    "# Overall\n",
    "CDI_US_age_adjusted_overall = CDI_US_age_adjusted.loc[CDI_US_age_adjusted['Stratification1']==\"Overall\",:]\n",
    "# Male\n",
    "CDI_US_age_adjusted_male = CDI_US_age_adjusted.loc[CDI_US_age_adjusted['Stratification1']==\"Male\",:]\n",
    "# Female\n",
    "CDI_US_age_adjusted_female = CDI_US_age_adjusted.loc[CDI_US_age_adjusted['Stratification1']==\"Female\",:]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "CDI_US_age_adjusted_overall.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "CDI_US_age_adjusted_male.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "CDI_US_age_adjusted_female.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
